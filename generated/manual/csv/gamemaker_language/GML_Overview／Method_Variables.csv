Method_Variables.htm+html.head.title:55-3,Method Variables
Method_Variables.htm+html.head.title:59-3,Method Variables
Method_Variables.htm+html.body.div.div.div[title]:73-7,Method Variables
Method_Variables.htm+html.body.div.div.div:73-7,Method Variables
Method_Variables.htm+html.body.h1:86-3,Method Variables
Method_Variables.htm+html.body.p:87-3,"A method variable is essentially a variable that has had a function assigned to it, ""binding"" the function to an instance and enabling you to use the variable to refer to the function - much like you use a <a href=""Runtime_Functions.htm"">runtime function name</a> to refer to a built-in GML function. The variable used can be <em>local</em>, <em>instance</em> or <em>global</em> in scope (see <a href=""Variables_And_Variable_Scope.htm"">here</a> for more information on variable scope)."
Method_Variables.htm+html.body.p:88-3,The syntax for creating a method variable is as follows:
Method_Variables.htm+html.body.p:89-3,"{ANY_CODE} &lt;variablename&gt; = function(&lt;parameter1&gt;, &lt;parameter2&gt;, etc... )<br /> {nbsp_x1} {nbsp_x1} {<br /> {nbsp_x1} {nbsp_x1} &lt;statement1&gt;;<br /> {nbsp_x1} {nbsp_x1} &lt;statement1&gt;;<br /> {nbsp_x1} {nbsp_x1} ...<br /> {nbsp_x1} {nbsp_x1} }"
Method_Variables.htm+html.body.p:90-3,or
Method_Variables.htm+html.body.p:91-3,"{ANY_CODE} function &lt;variablename&gt;(&lt;parameter1&gt;, &lt;parameter2&gt;, etc... )<br /> {nbsp_x1} {nbsp_x1} {<br /> {nbsp_x1} {nbsp_x1} &lt;statement1&gt;;<br /> {nbsp_x1} {nbsp_x1} &lt;statement1&gt;;<br /> {nbsp_x1} {nbsp_x1} ...<br /> {nbsp_x1} {nbsp_x1} }"
Method_Variables.htm+html.body.p:92-3,"In general, however, you would use the <em>first </em>form for methods, and the second form for defining <a href=""Script_Functions.htm"">script functions</a>, since the second form will also assign a script index to the function name while the first form will be a ""true"" method (and require the use of the <a href=""Variables/Global_Variables.htm"">global</a> prefix if used to define a scripted function)."
Method_Variables.htm+html.body.p:94-3,"<strong>NOTE</strong>: You can check this by using both forms in project and then calling the runtime function <a href=""../GML_Reference/Variable_Functions/typeof.htm"">typeof()</a> on each of them. One will be classed as a ""number"" - since it returns a script index ID - and the other will be classed as a ""method""."
Method_Variables.htm+html.body.p:96-3,"So, keep in mind that - in general - we will always be referring to functions that have <em>not </em>been defined with a script index when we are talking about methods and method variables."
Method_Variables.htm+html.body.p:97-3,Below you can see three simple examples of creating a method variable using different scopes:
Method_Variables.htm+html.body.p:98-3,"{ANY_CODE} // Local<br /> var _debug = function(message)<br /> {nbsp_x1} {nbsp_x1} {<br /> {nbsp_x1} {nbsp_x1} show_debug_message(message);<br /> {nbsp_x1} {nbsp_x1} }<br /> <br /> // Instance<br /> do_maths = function(val1, val2, val3)<br /> {nbsp_x1} {nbsp_x1} {<br /> {nbsp_x1} {nbsp_x1} return (val1 * val2) - val3;<br /> {nbsp_x1} {nbsp_x1} }<br /> <br /> // Global<br /> global.pd = function(_x1, _y1, _x2, _y2);<br /> {nbsp_x1} {nbsp_x1} {<br /> {nbsp_x1} {nbsp_x1} return point_distance(_x1, _y1, _x2, _y2);<br /> {nbsp_x1} {nbsp_x1} }"
Method_Variables.htm+html.body.p:101-3,"Notice that in the above code, the various parameters that are given as inputs for the function are all named and these names are what should be used within the function to refer to the different inputs. Also note that you can use the <span class=""inline""><a href=""Language_Features/return.htm"">return</a></span> statement to return a value from a function for use elsewhere in your code, and that a function with <em>no</em> return value defined, will return <span class=""inline"">undefined</span>.by default."
Method_Variables.htm+html.body.p:102-3,"<strong>NOTE</strong>: While the variable will be in the chosen scope, the actual function will be bound to the scope that it was initially defined in. For example, <a href=""Script_Functions.htm"">script functions</a> are all global scope and ""unbound"" (ie: they are not associated with any instances), but if you have a script function that creates another function as a method variable within it and then you call this script function from an instance, the function used within the script will <strong>be bound to the instance variable as a method</strong>. In general this is not something you ever need to think about but for more complex operations with method variables it's worth taking into consideration. This also applies when using other constructs like <a href=""Language_Features/with.htm""><span class=""inline"">with</span></a> - when you create a method variable inside a with, the function will be bound to the instance that is currently in scope."
Method_Variables.htm+html.body.p:105-3,"Once created, the method variable can be used just as you would a runtime function or a script function, for example:"
Method_Variables.htm+html.body.p:106-3,"{ANY_CODE} create_vec = function(_x1, _y1, _x2, _y2);<br /> {nbsp_x1} {nbsp_x1} {<br /> {nbsp_x1} {nbsp_x1} var _array;<br /> {nbsp_x1} {nbsp_x1} _array[0] = point_distance(_x1, _y1, _x2, _y2);<br /> {nbsp_x1} {nbsp_x1} _array[1] = point_direction(_x1, _y1, _x2, _y2);<br /> {nbsp_x1} {nbsp_x1} return _array;<br /> {nbsp_x1} {nbsp_x1} }<br /> vec = create_vec(x, y, mouse_x, mouse_y);"
Method_Variables.htm+html.body.p:108-3,"Variables created within a function will follow the same rules as normal and will be scoped according to the keyword used or the scope of the function call. In the above example, we use <span class=""inline"">var</span> so the array variable is in the <em>local </em>scope of the function. If we didn't use the keyword, then the variable would have been created on the scope of the instance that called the function."
Method_Variables.htm+html.body.p:110-3,"Method variables (and script functions) can also take a variable number of arguments, and you can use the built in <a href=""Variables/Builtin_Global_Variables/argument.htm""><tt>argument[0 ... n]</tt></a> array for the function parameters. You can then use the built in variable <a href=""Variables/Builtin_Global_Variables/argument_count.htm""><tt>argument_count</tt></a> to check for these extra parameters. For example:"
Method_Variables.htm+html.body.p:112-3,"{ANY_CODE} /// @function{nbsp_x17}create_random(object, layer);<br /> /// @param {int}{nbsp_x4}object {nbsp_x3}The object to create an instance of<br /> /// @param {int}{nbsp_x4}layer {nbsp_x4}OPTIONAL! The layer to create it on<br /> /// <br /> /// @description{nbsp_x4}Create an instance of the given object at a random position on the current layer or on the (optional) given layer<br /> <br /> function create_random(_obj)<br /> {nbsp_x4}{ <br /> {nbsp_x4}var _layer = layer;<br /> {nbsp_x4}if argument_count &gt; 1<br /> {nbsp_x8}{ <br /> {nbsp_x8}_layer = argument[1];<br /> {nbsp_x8}} <br /> {nbsp_x4}var _x = irandom(room_width);<br /> {nbsp_x4}var _y = irandom(room_height);<br /> {nbsp_x4}instance_create_layer(_x, _y, _layer, _obj);<br /> {nbsp_x4}}"
Method_Variables.htm+html.body.p:119-3,"<b>NOTE</b>: You cannot use the array <a href=""Accessors.htm"">accessor</a> @ when working with the <tt>argument[n]</tt> array."
Method_Variables.htm+html.body.p:120-3,"Use of the built in <a href=""Variables/Builtin_Global_Variables/argument.htm""><tt>argument[n]</tt></a> array is not strictly required, however, and you should be aware too that any arguments that are not provided to the function (but the function has an argument specified) will be initialised to ""<a href=""Data_Types.htm""><span class=""inline"">undefined</span></a>"". This means you do not need to use the above mentioned structure using <tt>argument_count</tt>, and can instead do something like this:"
Method_Variables.htm+html.body.p:123-3,{ANY_CODE} function my_func( _value)<br /> {nbsp_x4}{ <br /> {nbsp_x4}_value = is_undefined(_value) ? 10 : _value;<br /> {nbsp_x4}return _value * 10;<br /> {nbsp_x4}}
Method_Variables.htm+html.body.p:126-3,The code above would allow you to specify a default value for a parameter if the argument is not supplied to the function.
Method_Variables.htm+html.body.p:127-3,"<strong>NOTE</strong>: The above code uses the <strong>ternary operator</strong>, which you can find out more about <a href=""Language_Features/If_Else_and_Conditional_Operators.htm"">here</a>."
Method_Variables.htm+html.body.p:128-3,"An interesting feature of method variables (and script functions as well), is that they can have <strong>static variables</strong>. A static variable is one that is defined the first time that the function is called and that will maintain it's value from then onwards. To create a static variable you need to define it using the <span class=""inline"">static</span> keyword, as shown in this simple example:"
Method_Variables.htm+html.body.p:130-3,{ANY_CODE} counter = function()<br /> {nbsp_x1} {nbsp_x1} {<br /> {nbsp_x1} {nbsp_x1} static num = 0;<br /> {nbsp_x1} {nbsp_x1} return num++;<br /> {nbsp_x1} {nbsp_x1} }
Method_Variables.htm+html.body.p:131-3,"In the above example, the variable ""<span class=""inline"">num</span>"" is a static variable, and so will be defined as 0 the first time the function is called, but every time the function is called after that, the variable definition will be ignored. So, if you then call this function like this:"
Method_Variables.htm+html.body.p:133-3,{ANY_CODE} for (var i = 0; i &lt; 10; ++i;)<br /> {nbsp_x1} {nbsp_x1} {<br /> {nbsp_x1} {nbsp_x1} show_debug_message(counter());<br /> {nbsp_x1} {nbsp_x1} }
Method_Variables.htm+html.body.p:134-3,The output will be:
Method_Variables.htm+html.body.p:135-3,{ANY_CODE} 0<br /> 1 <br /> 2 <br /> 3 <br /> 4 <br /> 5 <br /> 6 <br /> 7 <br /> 8 <br /> 9
Method_Variables.htm+html.body.p:145-3,"If you didn't use the <span class=""inline"">static</span> keyword here then the output would simply be 0 for every iteration of the loop, since the variable ""<span class=""inline"">num</span>"" will be getting defined as 0 every time the function is called before being returned. Note that a static variable can only be changed inside the original function, outside you are getting a local instance variable (a copy of the static found inside the function) - essentially the shared static variable can only be changed by the function, the shared copy can only be written to by the function."
Method_Variables.htm+html.body.p:148-3,"You can also use the <span class=""inline"">static</span> keyword within a method (and a script function) to create a <strong>static function</strong>, which - like with variables - simply means that it is a function that will only be defined once the first time the method is used, for example:"
Method_Variables.htm+html.body.p:150-3,"{ANY_CODE} Vector2 = function( _x, _y ) constructor<br /> {nbsp_x1} {nbsp_x1} {<br /> {nbsp_x1} {nbsp_x1} x = _x;<br /> {nbsp_x1} {nbsp_x1} y = _y;<br /> {nbsp_x1} {nbsp_x1} static Add = function( _other )<br /> {nbsp_x1} {nbsp_x1} {nbsp_x1} {nbsp_x1} {<br /> {nbsp_x1} {nbsp_x1} {nbsp_x1} {nbsp_x1} x += _other.x;<br /> {nbsp_x1} {nbsp_x1} {nbsp_x1} {nbsp_x1} y += _other.y;<br /> {nbsp_x1} {nbsp_x1} {nbsp_x1} {nbsp_x1} }<br /> {nbsp_x1} {nbsp_x1} }"
Method_Variables.htm+html.body.p:151-3,"In the above example, the function <span class=""inline"">Vector2</span> can be used to create a struct, and the struct will have some variables, one of which is the method variable <span class=""inline"">Add</span>. Since this variable has been defined as static, the function it refers to will only be initialised <em>once </em>the first time the <span class=""inline"">Vector2</span> function is called, and all further structs created with this function will reference the function <span class=""inline"">Add</span> that was created initially, instead of creating a new function for each struct (for more information on structs and the <span class=""inline"">constructor</span> keyword please see <a href=""Structs.htm"">here</a>)."
Method_Variables.htm+html.body.p:153-3,Below we list a few helper functions associated with method variables:
Method_Variables.htm+html.body.ul.li:155-5,is_method
Method_Variables.htm+html.body.ul.li:156-5,method
Method_Variables.htm+html.body.ul.li:157-5,method_get_self
Method_Variables.htm+html.body.ul.li:158-5,method_get_index
Method_Variables.htm+html.body.div.div.div.div:166-9,"Back: <a href=""GML_Overview.htm"">GML Overview</a>"
Method_Variables.htm+html.body.div.div.div.div:167-9,"Next: <a href=""Structs.htm"">Structs</a>"
Method_Variables.htm+html.body.p:182-1,{SEARCH_RESULT} Page outlining the use of Method Variables
Method_Variables.htm+html.body.p:182-66,{INDEX_KEYWORD} Method Variables
